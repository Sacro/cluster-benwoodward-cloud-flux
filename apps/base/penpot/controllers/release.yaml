---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: penpot
  namespace: penpot
spec:
  chart:
    spec:
      chart: penpot
      reconcileStrategy: ChartVersion
      sourceRef:
        kind: HelmRepository
        name: penpot
      version: 0.x.x
  interval: 1m0s
  # https://github.com/penpot/penpot-helm/blob/develop/charts/penpot/values.yaml
  values:
    config:
      postgresql:
        host: pg-cluster-rw
        database: app

        existingSecret: pg-cluster-app
        secretKeys:
          usernameKey: username
          passwordKey: password
      publicUri: "https://penpot.benwoodward.cloud"
    global:
      valkeyEnabled: true
